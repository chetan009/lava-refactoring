target: paddington

job_name: panda-client

timeouts:
  job:
    minutes: 5
  action:
    minutes: 1
  test:
    minutes: 3

protocols:
  lava-multinode:
    # real multinode jobs will be parsed by the scheduler into separate YAML fies
    # so there are two files for the unittests which use a false target_group
    # these jobs are not expected to run, only support the unit tests
    target_group: panda-group-id  # only for unittest support
    role: client
    roles:
      paddington: client
      yogi: server
    group_size: 2
    sub_id: 1

priority: medium

actions:

  # needs to be a list of hashes to retain the order
  - deploy:
     timeout:
       minutes: 2
     to: tftp
     kernel: http://images.validation.linaro.org/functional-test-images/panda/uImage
     ramdisk: http://images.validation.linaro.org/functional-test-images/common/linaro-image-minimal-initramfs-genericarmv7a.cpio.gz.u-boot
     ramdisk-type: u-boot
     os: oe
     dtb: http://images.validation.linaro.org/functional-test-images/panda/omap4-panda-es.dtb

  - boot:
     timeout:
       minutes: 4
     method: u-boot
     commands: ramdisk
     type: bootm

  - test:
     role: client
     failure_retry: 3
     name: panda-basic-multinode
     definitions:
         - repository: http://git.linaro.org/lava-team/lava-functional-tests.git
           from: git
           path: lava-test-shell/multi-node/multinode01.yaml
           name: multinode-basic
